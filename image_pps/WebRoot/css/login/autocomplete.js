var CI=CI||{};CI.UI=CI.UI||{};CI.UI.AutoComplete=CI.UI.AutoComplete||{};CI.UI.AutoComplete.Labels=CI.UI.AutoComplete.Labels||{};CI.UI.AutoComplete.Labels={turnOffAutoComplete:"关闭搜索自动提示"};(function(a){var f=0;function b(h,j){var k=this;var i={delay:10,minLength:1,source:function(l,m){l.lcid=CorbisData.Locale;if(k.xhr){k.xhr.abort();}k.xhr=a.ajax({url:"/autocomplete/",data:l,dataType:"json",cache:true,autocompleteRequest:++f,success:function(n,o){if(this.autocompleteRequest===f){m(n);}},error:function(){if(this.autocompleteRequest===f){m([]);}}});}};a.extend(true,i,j);var g=h.autocomplete(i);if(g){autoCompleteData=g.data("autocomplete");if(autoCompleteData){autoCompleteData._renderMenu=e;autoCompleteData._renderItem=d;}}}function e(i,g){var h=this;a("<li></li>").addClass("autocomplete-header").appendTo(i);a.each(g,function(j,k){h._renderItem(i,k);});a("<li></li>").addClass("autocomplete-turn-off").text(CI.UI.AutoComplete.Labels.turnOffAutoComplete).appendTo(i);}function d(h,g){return a("<li></li>").data("item.autocomplete",g).append(a("<a></a>").html(c(this.term,g.label))).appendTo(h);}function c(h,g){return g.substr(0,h.length)+"<strong>"+g.substr(h.length)+"</strong>";}this.attach=function(g,h){b(g,h);};}).apply(CI.UI.AutoComplete,[jQuery]);(function(a){function c(){var d=CI.UI.Cookie.parseCookie(CI.UI.Cookie.getCookie("resultsDisplayOptionsCookie"));var e=CI.UI.Cookie.parseCookie(CI.UI.Cookie.getCookie("Search"));if(d){return d.autocomplete;}else{if(e){return e.AutoComplete=="True";}}return true;}var b=a("#searchbar, #Keywords input[type='text']");CI.UI.AutoComplete.attach(b,{disabled:!c()});a("li.autocomplete-turn-off").live("click",function(d){b.trigger("onAutoCompleteDisable");b.autocomplete("close");CI.UI.Cookie.addValues("resultsDisplayOptionsCookie",{autocomplete:false},{expires:365,path:"/"});CI.UI.Cookie.addValues("Search",{AutoComplete:"False"},{expires:365,path:"/"},"keyvalue");});b.bind("onAutoCompleteEnable",function(d){b.autocomplete("enable");});b.bind("onAutoCompleteDisable",function(d){b.autocomplete("disable");});})(window.jQuery);