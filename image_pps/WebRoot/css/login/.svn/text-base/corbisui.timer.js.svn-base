if(!CorbisUI){var CorbisUI={};}CorbisUI.Timer=function(f,e,b,j,d){this.timers={};this.ActivityUid=e;this.SessionId=f;this.MarketId=b;this.SearchUid=j;this.NamePrefix="cs_";this.myquery="..";this.myuri="..";this.ptype="search";this.startTime=d?d:CorbisUI.getMicroTimestamp();this.get=function(o,p){if(this.NamePrefix!=""){o=this.NamePrefix+o;}var q=this.timers[o];if(!q){if(!p){p=CorbisUI.getMicroTimestamp();}q=new CorbisUI.SingleTimer(o,p);this.timers[o]=q;}return q;};function g(o,p){this.get(o,p).start(p);}function h(o,p){this.get(o).stop(p);}function i(){for(var o in this.timers){this.timers[o].stop();}}function l(o){o.b("{").b('"header":');o.b('{"rid":"').b(this.ActivityUid).b('",');o.b('"sid":"').b(this.SessionId).b('",');o.b('"mid":"').b(this.MarketId).b('",');o.b('"suid":"').b(this.SearchUid).b('",');o.b('"query":"').b(escape(this.myquery)).b('",');o.b('"ptype":"').b(escape(this.ptype)).b('",');o.b('"uri":"').b(escape(this.myuri)).b('"}');o.b(',"values":{');for(var p in this.timers){this.timers[p].to_buf_json(o,this.startTime);o.b(",");}o[o.length-1]="";o.b("}");o.b("}");return o;}function k(o){for(var p in this.timers){atimer=this.timers[p];o.b(this.SessionId).b(",");o.b(this.ActivityUid).b(",");o.b(atimer.afirst-this.startTime).b(",");o.b(atimer.astop-this.startTime).b(",");o.b(atimer.aelap).b(",");o.b(escape(atimer.name));o.b("\n");}return o;}function n(){var o=new Strbuf();this.to_buf_cdf(o);return o.to_str();}this.to_json_str=function(){var o=new Strbuf();this.to_buf_json(o);return o.to_str();};function m(o,p){if(!p){return;}var q=new Strbuf();q.b("<br clear=all /><pre>");q.b("sid,rid,first,stop,elap,name\n");this.to_buf_cdf(q);q.b("</pre>");q.to_div(o);document.getElementById(o).style.display="block";}function a(p,o){if(o){p.log(o);}var o=this.to_str();p.log(o);}function c(){if(this.myuri==".."){var p=window.location.href;var o=p.split("?",2);this.myuri=o[0];if((o.length>1)&&(this.myquery=="..")){this.myquery=o[1];}}if(this.myquery==".."){var p=window.location.href;var o=p.split("#",2);this.myuri=o[0];if(o.length>1){this.myquery=o[1];}}}this.reportJSON=function(p){if(!p){p="/common/Timer.asmx/Report";}this.parse_uri();var o=["data=",this.to_json_str()].join("");try{var r=this.getHttpRequest();r.open("POST",p,true);r.setRequestHeader("Content-type","application/x-www-form-urlencoded");r.send(o);}catch(q){}};this.getHttpRequest=function(){if(window.XMLHttpRequest){return new XMLHttpRequest();}else{return new ActiveXObject("Microsoft.XMLHTTP");}};this.isProfile=function(){var p="isProfile=";var o=location.hash;var q=o.indexOf(p);if(q==-1||q+p.length+1>o.length){return false;}q+=p.length;o=o.substring(q,q+1);if(o=="t"||o=="1"){return true;}return false;};this.start=g;this.stop=h;this.stop_all=i;this.to_buf=k;this.to_buf_cdf=k;this.to_buf_json=l;this.to_div=m;this.parse_uri=c;};CorbisUI.Timer.ajaxInit=function(){return new CorbisUI.Timer(CorbisUI.TimerCache.SessionId,null,CorbisUI.TimerCache.MarketId,null,CorbisUI.getMicroTimestamp());};CorbisUI.TimerCache={SessionId:null,MarketId:null};