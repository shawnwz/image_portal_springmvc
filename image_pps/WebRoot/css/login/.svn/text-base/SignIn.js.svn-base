if(typeof CorbisUI=='undefined'){var CorbisUI={}}CorbisUI.SignIn=CorbisUI.SignIn||{};
CorbisUI.SignIn.errorLabel={"invalidUserPassCombination":"Please enter a valid <b>Username / Email</b> and <b>Password</b> combination.","multipleEmailsError":"The email address you provided is associated with more than one Corbis account. Please enter your <b>username</b>."};jQuery.extend(CorbisUI.SignIn.errorLabel, {"invalidUserPassCombination":"请输入正确的 <b>用户名/电邮地址</b> 和 <b>密码</b> 的组合。","multipleEmailsError":"您输入的电子邮件地址与不止一个 Corbis 帐户有关联。请输入您的<b>用户名</b>"});(function(a,h){var g="highlightedField";var n=a("#signInButton"),o=a("#usernameOrEmail"),j=a("#password"),d=a("#error"),b=a("#ajaxLoader"),p=a("#form label[for=usernameOrEmail]"),k=a("#form label[for=password]");var q={None:0,InvalidLogin:1,UserValidated:4,PasswordChangeRequired:8,PasswordRecoveryQuestionRequired:16,MultipleUsersForEmail:32};(function(){n.click(function(){c();i(a.trim(o.val()),j.val());return false;});o.bindEnterKey(function(){n.click();},function(){return a.trim(this.val())&&j.val();});j.bindEnterKey(function(){n.click();},function(){return this.val()&&a.trim(o.val());});if(o.val().length===0){o.focus();}})();function c(){d.hide();p.removeClass(g);k.removeClass(g);}function m(r){switch(r){case h.errorLabel.invalidUserPassCombination:p.addClass(g);k.addClass(g);break;case h.errorLabel.multipleEmailsError:p.addClass(g);k.removeClass(g);o.select();break;}d.html(r);d.show();}var l=(function(){var r=a.deparam.querystring();return r.redirect||r.ReturnUrl||CorbisData.RootUrl;})();function e(){if(f()){return false;}return true;}function f(){var u=l.toLowerCase(),r={current:["activationid","activate"],legacy:["activationinfo","activeondemand"]};for(var s in r){var t=r[s];if(u.indexOf(t[0])>-1&&u.indexOf(t[1])>-1){return true;}}return false;}function i(s,r){if(!s||!r){m(h.errorLabel.invalidUserPassCombination);return;}b.show();a.post("validate-sign-in",{usernameOrEmail:s,password:r},function(t){var u=t.userStatus;var v=t.countryCodeMismatch&&e()?CorbisData.RootUrl:l;if((u&q.UserValidated)==q.UserValidated){location.href=v;}else{if((u&q.PasswordChangeRequired)==q.PasswordChangeRequired){location.href="update-password?redirect="+encodeURIComponent(v);}else{if((u&q.InvalidLogin)==q.InvalidLogin){b.hide();m(h.errorLabel.invalidUserPassCombination);}else{if((u&q.MultipleUsersForEmail)==q.MultipleUsersForEmail){b.hide();m(h.errorLabel.multipleEmailsError);}else{throw new Error('Unrecognized return value "'+u+'" from ajax response');}}}}});}})(window.jQuery,CorbisUI.SignIn);
